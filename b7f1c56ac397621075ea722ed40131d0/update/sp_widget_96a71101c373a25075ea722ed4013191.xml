<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[api.controller=function() {
  /* widget controller */
  var c = this;
	
	console.log(c);
};]]></client_script>
        <controller_as>c</controller_as>
        <css>.kpi-card {
    background-color: #f9f9f9;
    border: 1px solid #ddd;
    border-radius: 5px;
    padding: 15px;
    margin-bottom: 10px;
    text-align: center;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); /* subtle shadow */
    transition: transform 0.2s, box-shadow 0.2s; /* smooth hover effect */
}

.kpi-card:hover {
    box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2); /* deeper shadow on hover */
    transform: translateY(-3px); /* slight lift effect */
}

.kpi-card i {
    font-size: 32px;
    color: #007bff;
    margin-bottom: 10px;
}

.kpi-card h4 {
    font-size: 16px;
    color: #333;
    margin-bottom: 10px;
}

.kpi-value {
    font-size: 24px;
    font-weight: bold;
    color: #007bff;
}
</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>true</has_preview>
        <id>my_recognition_snapshot</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>My Recognition Snapshot</name>
        <option_schema>[{"hint":"Number of days to consider for recognitions","name":"days","section":"Data","default_value":"90","label":"Days","type":"integer"}]</option_schema>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
		var user = gs.getUserID();
    var days = options.days || 90; // Default to 90 if not provided

    var received = 0, given = 0;
    
		// Get recognition count given by each user
    var gaGiven = new GlideAggregate('x_1794402_peerce_0_peer_recognition');
		gaGiven.addQuery('sender', user);
    gaGiven.addAggregate('COUNT', 'sender');
    gaGiven.addQuery('sys_created_on', '>=', gs.daysAgo(days));

    gaGiven.query();

    while (gaGiven.next()) {
			given = parseInt(gaGiven.getAggregate('COUNT', 'sender'), 10);
    }


    // Get recognition count received by current user
    var gaReceived = new GlideAggregate('x_1794402_peerce_0_recognition_recipient');
    gaReceived.addNotNullQuery('recipient_user');
		gaReceived.addQuery('recipient_user', user);
    gaReceived.addAggregate('COUNT', 'recipient_user');
    gaReceived.addQuery('sys_created_on', '>=', gs.daysAgo(days));
    gaReceived.query();

    if (gaReceived.next()) {
        received = parseInt(gaReceived.getAggregate('COUNT', 'recipient_user'), 10);
    }

    // Limit to top 5
    data.given = given;
    data.received = received;
    data.total = given + received;

})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-09-03 15:42:21</sys_created_on>
        <sys_id>96a71101c373a25075ea722ed4013191</sys_id>
        <sys_mod_count>31</sys_mod_count>
        <sys_name>My Recognition Snapshot</sys_name>
        <sys_package display_value="PeerCentral" source="x_1794402_peerce_0">b7f1c56ac397621075ea722ed40131d0</sys_package>
        <sys_policy/>
        <sys_scope display_value="PeerCentral">b7f1c56ac397621075ea722ed40131d0</sys_scope>
        <sys_update_name>sp_widget_96a71101c373a25075ea722ed4013191</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-09-03 16:39:15</sys_updated_on>
        <template><![CDATA[<div class="panel panel-primary">
    <div class="panel-heading">
        <h3 class="panel-title"><i class="glyphicon glyphicon-stats"></i> My Recognition Snapshot (Last {{c.options.days}} Days)</h3>
    </div>
    <div class="panel-body pb-5">
        <div class="row">
            <div class="col-xs-6">
                <div class="kpi-card">
                    <i class="glyphicon glyphicon-send"></i>
                    <h4>Recognitions Given</h4>
                    <p class="kpi-value">{{c.data.given || 0}}</p>
                </div>
            </div>
            <div class="col-xs-6">
                <div class="kpi-card">
                    <i class="glyphicon glyphicon-inbox"></i>
                    <h4>Recognitions Received</h4>
                    <p class="kpi-value">{{c.data.received || 0}}</p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12">
                <div class="kpi-card">
                    <i class="glyphicon glyphicon-thumbs-up"></i>
                    <h4>Total Recognitions</h4>
                    <p class="kpi-value">{{c.data.total || 0}}</p>
                </div>
            </div>
        </div>
    </div>
</div>
]]></template>
    </sp_widget>
    <sys_es_latest_script action="INSERT_OR_UPDATE">
        <id>96a71101c373a25075ea722ed4013191</id>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-09-03 15:42:22</sys_created_on>
        <sys_id>1ea71101c373a25075ea722ed4013193</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-09-03 15:42:22</sys_updated_on>
        <table>sp_widget</table>
        <use_es_latest>true</use_es_latest>
    </sys_es_latest_script>
</record_update>
