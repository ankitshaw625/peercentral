<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[api.controller = function($scope, $location, $timeout) {
	var c = this;
	
	c.data.filteredRecognitions = [];
	c.isLoading = false;           
	c.isLoadingMore = false;
	c.canLoadMore = true;
	
	c.offset = 0;                 
	c.limit = c.options.limit || 10;                 
	c.sortOrder = 'newest';
	
	// State
	c.filters = {
		activity: 'all',
		timeframe: 'all',
		occasion: ''
	};

	c.availableTags = ['Kudos', 'Milestone', 'Welcome', 'Farewell'];

	// Reset filters
	c.resetFilters = function() {
		c.filters = { activity: 'all', timeframe: 'all', occasion: '' };
		c.setTab(c.activeTab);
	};

	// Check if any filter is active
	c.hasActiveFilters = function() {
		return c.filters.activity !== 'all' ||
			c.filters.timeframe !== 'all' ||
			c.filters.occasion !== '';
	};

	c.setSortOrder = function(order) {
			if (c.sortOrder === order) return;
		
			c.sortOrder = order;
			c.setTab(c.activeTab);
	};
	
	
	c.setTab = function(tabName) {
		if (!tabName) return;
		
		c.activeTab = tabName;
		$location.hash(tabName);
		
		c.offset = 0;
		c.canLoadMore = true;
		c.isLoading = true;
		loadFeed(tabName, 0, false);
	};
	
	c.loadMore = function() {
		if (!c.canLoadMore || c.isLoadingMore) return;
		
		c.isLoadingMore = true;
		
		loadFeed(c.activeTab, c.offset, true);
	};
	
	
	var initialTab = $location.hash() || 'you';
	c.setTab(initialTab);
	
	$scope.$on('$locationChangeSuccess', function() {
		var newTab = $location.hash();
		
		if (newTab && newTab !== c.activeTab) {
			c.setTab(newTab);
		}
	});
	
	function loadFeed(feedType, offset, append) {
		
    c.server.get({ feedType, limit: c.limit, offset, sortOrder: c.sortOrder, action: 'getFeed' })
        .then(function(response) {
            const newRecognitions = transformRecognitions(response.data.recognitions || []);
			
						if (append) {
							c.data.filteredRecognitions = c.data.filteredRecognitions.concat(newRecognitions);
						} else {
							c.data.filteredRecognitions = newRecognitions;
						}

						// Update the offset
						c.offset = offset + newRecognitions.length;

						// If we got fewer than the limit, no more records left to load
						c.canLoadMore = newRecognitions.length >= c.limit;

        })
        .catch(function(error) {
            console.error('Failed to load feed:', error);
						if (!append) c.data.filteredRecognitions = [];

        }).finally(function() {
						c.isLoading = false;
						c.isLoadingMore = false;
				});
	}
	
	function transformRecognitions(recognitions) {
    return recognitions.map(function(rec) {
        return {
            ...rec,                         
            senderInitials: generateInitials(rec.senderDisplay),
            timeAgo: formatTimeAgo(rec.createdOn)
        };
    });
	}
	
	function generateInitials(name) {
    if (!name) return '?';
		
    return name.split(/\s+/)              
               .map(part => part[0] ? part[0].toUpperCase() : '') 
               .join('')                   
               .substring(0, 2) || '?';    
	}
	
	
	function formatTimeAgo(dateTime) {
    if (!dateTime) return '';
    
    var m = moment(dateTime, "YYYY-MM-DD HH:mm:ss");

    return m.fromNow();
	}
	
	
	moment.updateLocale('en', {
		relativeTime: {
			future: "in %s",
			past:   "%s ago",
			s:      "a few seconds", 
			ss:     "%d seconds",    
			m:      "a minute",      
			mm:     "%d minutes",
			h:      "an hour",      
			hh:     "%d hours",
			d:      "a day",      
			dd:     "%d days",
			M:      "a month",    
			MM:     "%d months",
			y:      "a year",      
			yy:     "%d years"
		}
	});
};]]></client_script>
        <controller_as>c</controller_as>
        <css>.nav-tabs li a:hover {
	cursor: pointer;
}

.nav-tabs &gt; li &gt; a:focus,
.nav-tabs &gt; li &gt; a:active {
  outline: none;
  box-shadow: none;
}

.nav-tabs &gt; li.active &gt; a {
  border: none;
  border-bottom: 0.2rem solid #2D7524;
}


.refresh-btn {
	border-bottom: .1rem solid #CFD5D7;
}

.refresh-btn .fa-refresh {
  font-size: 18px !important;
  color: #666;   
  transition: transform 0.1s ease; 
}


.refresh-btn:active .fa-refresh {
  transform: scale(0.9);
}

.refresh-btn:focus,
.refresh-btn:active {
  outline: none;
  box-shadow: none !important;
  background-color: transparent !important; 
  border-color: transparent !important; 
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Control Bar
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.controls-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 12px;
  background: #fff;
  border-bottom: 1px solid #eee;
  font-size: 12px;
}

.filters {
  display: flex;
  gap: 6px;
  align-items: center;
}

.filters &gt; *:not(:first-child) {
  margin-left: 6px;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Filter Select (Pill Style)
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.filter-select, .sort-select {
  padding: 4px 24px 4px 10px; /* ðŸ‘ˆ Add right padding for arrow */
  border: 1px solid #ddd;
  border-radius: 12px;
  background: #fff;
  color: #333;
  font: inherit;
  cursor: pointer;
  outline: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  background-image: url("image/svg+xml;charset=US-ASCII,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%23333'%3E%3Cpath d='M6 9l-5-5h10z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 8px center;
  background-size: 8px;
  min-width: 100px; /* Prevents too-narrow sizing */
}

.filter-select:hover,
.filter-select:focus,
.sort-select:hover,
.sort-select:focus {
  border-color: #2D7524;
  color: #2D7524;
  background-image: url("image/svg+xml;charset=US-ASCII,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%232D7524'%3E%3Cpath d='M6 9l-5-5h10z'/%3E%3C/svg%3E"); /* Match arrow color */
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Sort Select
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.sort-select {
  padding: 3px 20px 3px 8px; /* ðŸ‘ˆ Right padding for arrow */
  width: auto;
  min-width: 60px;
  text-align: center;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Reset Link
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.reset-link {
  color: #999;
  text-decoration: none;
  margin-left: 6px;
  line-height: 1;
}

.reset-link:hover {
  color: #2D7524;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Dropdown Styling (Best Effort)
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
/* Chrome, Edge, Opera */
.filter-select:focus::-webkit-list-box,
.sort-select:focus::-webkit-list-box {
  border-radius: 8px;
  border: 1px solid #2D7524;
  box-shadow: 0 2px 8px rgba(0,0,0,0.15);
}

/* Firefox â€” very limited */
.filter-select {
  padding-block: 2px; /* Firefox vertical padding tweak */
}

/* No reliable cross-browser way to style option list border-radius or shadow */
/* But the toggle button looks perfect and consistent */


/* This container is the positioning anchor for the overlay */
.feed-container {
  position: relative;
}

/* This is the spinner overlay itself */
.feed-loading-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 10;
  display: flex;
  justify-content: center;
  
  align-items: flex-start;
  
  padding-top: 50px;
  
  background: white;
}

/* This is the list of recognitions */
.feed-content {
  opacity: 1;
  transition: opacity 0.4s linear;
}

/* This class is applied to the list when the spinner is active */
.feed-content.content-faded {
  opacity: 0.5;
  pointer-events: none; 
}

.recognition-indicators abbr {
	display: inline-block;
  cursor: pointer;
}

.private-indicator {
	color: #7B6EA2;
}

.team-indicator {
	color: #007BFF;
}


.occasion-tag {
  font-size: 1rem;
  border-radius: 3px
}</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>true</has_preview>
        <id>recognition_feed</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>Recognition Feed</name>
        <option_schema>[{"hint":"Number of records displayed in a page.","name":"limit","section":"Data","default_value":"15","label":"Record Limit","type":"integer"}]</option_schema>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
	
	if (input && input.action == 'getFeed') {
	
		const currentFeed = input.feedType || 'you';
		const limit = parseInt(input.limit, 10) || 15;
		const offset   = parseInt(input.offset, 10) || 0;
		const sortOrder = input.sortOrder || 'newest'; 
		
		const recognitionDAO = new x_1794402_peerce_0.RecognitionDAO();

		data.recognitions = recognitionDAO.getRecognitionsForFeed(currentFeed, limit, offset, sortOrder) || [];
		
	}

	
})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-08-14 13:19:41</sys_created_on>
        <sys_id>09377deec39b621075ea722ed4013146</sys_id>
        <sys_mod_count>447</sys_mod_count>
        <sys_name>Recognition Feed</sys_name>
        <sys_package display_value="PeerCentral" source="x_1794402_peerce_0">b7f1c56ac397621075ea722ed40131d0</sys_package>
        <sys_policy/>
        <sys_scope display_value="PeerCentral">b7f1c56ac397621075ea722ed40131d0</sys_scope>
        <sys_update_name>sp_widget_09377deec39b621075ea722ed4013146</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-09-20 16:46:58</sys_updated_on>
        <template><![CDATA[<main>
<div class="panel panel-primary">
  <!-- Default panel contents -->
  <section class="panel-heading">
  	<h3 class="panel-title">
      <strong>Recognition activity feed</strong>
    </h3>
  </section>
  
  <nav>
    <ul class="nav nav-tabs">
      <li role="presentation" ng-class="{active: c.activeTab=='you'}">
        <a href="" ng-click="c.setTab('you')">You</a>
      </li>
      
      <li role="presentation" ng-class="{active: c.activeTab=='team'}">
        <a href="" ng-click="c.setTab('team')">Team</a>
      </li>
      
      <li role="presentation" ng-class="{active: c.activeTab=='all'}">
        <a href="" ng-click="c.setTab('all')">All</a>
      </li>
      
      <li class="pull-right">
        <a href=""
           ng-click="!c.isLoading && c.setTab(c.activeTab)"
           title="Refresh feed"
           class="btn btn-default btn-sm refresh-btn"
           ng-class="{'is-loading': c.isLoading}">
          <i class="fa fa-refresh"
             ng-class="{'fa-spin': c.isLoading}"
             aria-hidden="true"></i>
          <span class="sr-only">Refresh</span>
        </a>
      </li>

      
    </ul>
  </nav>
  
  <div class="controls-bar">
    <div class="filters">

      <!-- Activity Filter -->
      <select class="filter-select"
              ng-model="c.filters.activity"
              ng-change="c.setTab(c.activeTab)">
        <option value="all">Activity: All</option>
        <option value="sent">Activity: Sent</option>
        <option value="received">Activity: Received</option>
      </select>

      <!-- Timeframe Filter -->
      <select class="filter-select"
              ng-model="c.filters.timeframe"
              ng-change="c.setTab(c.activeTab)">
        <option value="all">All</option>
        <option value="7d">Last 7 days</option>
        <option value="30d">Last 30 days</option>
        <option value="90d">Last 90 days</option>
      </select>

      <!-- Occasion Filter -->
      <select class="filter-select"
              ng-model="c.filters.occasion"
              ng-change="c.setTab(c.activeTab)">
        <option value="">Occasion: None</option>
        <option ng-repeat="tag in c.availableTags" value="{{tag}}">{{tag}}</option>
      </select>

      <!-- Reset Button -->
      <a href ng-click="c.resetFilters()" ng-show="c.hasActiveFilters()" class="reset-link">â†º</a>
    </div>

    <!-- Sort Toggle -->
    <select class="sort-select"
            ng-model="c.sortOrder"
            ng-change="c.setTab(c.activeTab)">
      <option value="newest">]]>ðŸ —<![CDATA[ Newest</option>
      <option value="oldest">]]>ðŸ •<![CDATA[ Oldest</option>
    </select>
  </div>
  
  <!-- List group -->
  <section class="feed-container">
    
    <div ng-if="c.isLoading" class="feed-loading-overlay">
      <i class="fa fa-spinner fa-spin fa-2x text-muted"></i>
    </div>

    <ul class="list-group feed-content" ng-class="{'content-faded': c.isLoading}">
      <li ng-repeat="recognition in c.data.filteredRecognitions track by recognition.id" class="list-group-item">
        <article class="media">
          
          <div class="media-left">
             <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x text-info"></i>
                <span class="fa-stack-1x fa-inverse">{{recognition.senderInitials}}</span>
             </span>
          </div>

          <div class="media-body p-5">
            <h4 class="media-heading">
              <a href>{{recognition.senderDisplay}}</a> gave applause to <a href>{{recognition.recipients.join(', ')}}</a> 
							
              <small class="text-muted pull-right">{{recognition.timeAgo}}</small> 
              
            </h4>
            
            <span class="recognition-indicators mb-5 pull-right">
              <abbr title="Private Recognition" class="private-indicator initialism ml-10" ng-if="recognition.isPrivate">
                <i class="fa fa-lock" aria-hidden="true"></i>
              </abbr>

              <abbr  title="Team Recognition" class="team-indicator initialism ml-10" ng-if="recognition.isTeam">
                <i class="fa fa-users" aria-hidden="true"></i>
              </abbr>
            </span>
            


            <p ng-if="recognition.message" ng-bind-html="recognition.message"></p>
            
						<span ng-repeat="occasion in recognition.occasions">
            	<small class="label label-default occasion-tag" title={{occasion}}>
                <strong>{{occasion}}</strong>
              </small>&nbsp;
          	</span>
            
          </div>
        </article>
      </li>
      
      <li class="text-center">
        <div class="well well-sm text-center mb-0"> 
          <p class="text-muted small">
            Showing <strong>{{c.data.filteredRecognitions.length}}</strong> 
            {{c.data.filteredRecognitions.length === 1 ? 'recognition' : 'recognitions'}}
          </p>

          <div ng-if="c.canLoadMore">
            <button class="btn btn-primary btn-sm" ng-click="c.loadMore()" ng-disabled="c.isLoadingMore">
              <i class="fa" ng-class="{'fa-spin fa-spinner': c.isLoadingMore, 'fa-arrow-down': !c.isLoadingMore}"></i>
              {{c.isLoadingMore ? 'Loading...' : 'Load More'}}
            </button>
          </div>
          
          <p ng-if="!c.canLoadMore && c.data.filteredRecognitions.length > 0" class="text-center text-muted small m-0">
          	<em>â€” You've reached the end of the list â€”</em>
        	</p>
          
        </div>
      </li>

      <li ng-if="!c.data.filteredRecognitions.length" class="list-group-item text-center pt-20 pb-20">
        <div class="p-20"> <p class="text-muted">
            <i class="fa fa-trophy fa-3x" aria-hidden="true"></i>
          </p>
          <h4 class="text-muted">No Recognitions Found</h4>
          <p class="small text-muted">Try adjusting your filters or check back later.</p>
        </div>
      </li>
      


    </ul>
   </section>

 </div>
</main>]]></template>
    </sp_widget>
    <sys_es_latest_script action="INSERT_OR_UPDATE">
        <id>09377deec39b621075ea722ed4013146</id>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-08-14 13:19:41</sys_created_on>
        <sys_id>8d377deec39b621075ea722ed4013148</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-08-14 13:19:41</sys_updated_on>
        <table>sp_widget</table>
        <use_es_latest>true</use_es_latest>
    </sys_es_latest_script>
</record_update>
