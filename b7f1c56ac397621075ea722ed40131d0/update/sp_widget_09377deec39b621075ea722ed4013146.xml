<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[api.controller = function($scope, $location) {
  /* widget controller */
  var c = this;
	
	c.activeTab = 'you';
	
	// Initialize tab from URL hash if present
  if ($location.hash()) {
    c.activeTab = $location.hash();
  }
	
	c.data.recognitions = c.data.recognitions.map(function(recognition) {
		var senderInitials = recognition.senderDisplay.split(' ').map(function(namePart) {
			return namePart[0].toUpperCase();	
		}).join('');
		
		return {...recognition, timeAgo: convertToTimeAgo(recognition.createdOn), senderInitials: senderInitials};
	});
	
	console.log(c.data);
	
	
	
	// Controller methods
	c.setTab = function(tabName) {
		c.activeTab = tabName;
		$location.hash(tabName);
	};
	
	
	// Even listeners
	// listen for back/forward navigation, switch to the tab as per hash
  $scope.$on('$locationChangeSuccess', function() {
    var newHash = $location.hash();
    if (newHash)
      c.activeTab = newHash;
  });
	
	// Helper methods
	function convertToTimeAgo(dateTime) {
		if (!dateTime) return '';
		
		moment.updateLocale('en', {
			relativeTime: {
				future: "in %s",
				past:   "%s ago",
				s:      "a few seconds", 
				ss:     "%d seconds",    
				m:      "a minute",      
				mm:     "%d minutes",
				h:      "an hour",      
				hh:     "%d hours",
				d:      "a day",      
				dd:     "%d days",
				M:      "a month",    
				MM:     "%d months",
				y:      "a year",      
				yy:     "%d years"
			}
		});
		
		return moment(dateTime).fromNow();
	}
};]]></client_script>
        <controller_as>c</controller_as>
        <css>.nav-tabs li a:hover {
	cursor: pointer;
}

.nav-tabs &gt; li &gt; a:focus,
.nav-tabs &gt; li &gt; a:active {
  outline: none;
  box-shadow: none;
}

.nav-tabs &gt; li.active &gt; a {
  border: none;
  border-bottom: 0.2rem solid #2D7524;
}

.nav-tabs &gt; li.analytics &gt; a:focus {
	border: none;
}</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>true</has_preview>
        <id>recognition_feed</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>Recognition Feed</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
	
	var limit = options.limit || 10;
	
	var recognitionDAO = new x_1794402_peerce_0.RecognitionDAO();
	
	data.recognitions = recognitionDAO.getRecognitions(limit);

	
})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-08-14 13:19:41</sys_created_on>
        <sys_id>09377deec39b621075ea722ed4013146</sys_id>
        <sys_mod_count>181</sys_mod_count>
        <sys_name>Recognition Feed</sys_name>
        <sys_package display_value="PeerCentral" source="x_1794402_peerce_0">b7f1c56ac397621075ea722ed40131d0</sys_package>
        <sys_policy/>
        <sys_scope display_value="PeerCentral">b7f1c56ac397621075ea722ed40131d0</sys_scope>
        <sys_update_name>sp_widget_09377deec39b621075ea722ed4013146</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-08-24 17:03:56</sys_updated_on>
        <template><![CDATA[<main>
<div class="panel panel-primary">
  <!-- Default panel contents -->
  <section class="panel-heading">
  	<h3 class="panel-title">
      <strong>Recognition activity feed</strong>
    </h3>
  </section>
  
  <nav>
    <ul class="nav nav-tabs">
      <li role="presentation" ng-class="{active: c.activeTab=='you'}">
        <a href="" ng-click="c.setTab('you')">You</a>
      </li>
      <li role="presentation" ng-class="{active: c.activeTab=='team'}">
        <a href="" ng-click="c.setTab('team')">Team</a>
      </li>
      <li role="presentation" ng-class="{active: c.activeTab=='all'}">
        <a href="" ng-click="c.setTab('all')">All</a>
      </li>
      <li role="presentation" class="analytics">
        <a href="/pc?id=recognition_analytics" target="_blank">Analytics âžš</a>
      </li>
    </ul>
  </nav>

  <!-- List group -->
  <ul class="list-group">
    <li ng-repeat="recognition in data.recognitions" class="list-group-item">
      <article class="media">
        <div class="media-left">
           <span class="fa-stack fa-lg">
            	<i class="fa fa-circle fa-stack-2x text-info"></i>
            	<span class="fa-stack-1x fa-inverse">{{recognition.senderInitials}}</span>
           </span>  
  			</div>
        
        <div class="media-body p-5">
          <h4 class="media-heading">
            <a href>{{recognition.senderDisplay}}</a> gave applause to
            <a href>{{recognition.recipients.join(', ')}}</a> <small class="text-muted pull-right">{{recognition.timeAgo}}</small>
          </h4>
          
          <p ng-bind-html="recognition.message"></p>
          
          <small class="label label-default"><strong>{{recognition.categoryDisplay}}</strong></small>
          
        </div>
      </article>
    </li>
    
    <p class="text-center p-5">Viewing {{data.recognitions.length}} out of {{data.recognitions.length}} total recognitions.</p>
    
    <li ng-if="!data.recognitions.length" class="list-group-item text-muted">
      No recognitions found.
    </li>
  </ul>

</div>
</main>]]></template>
    </sp_widget>
    <sys_es_latest_script action="INSERT_OR_UPDATE">
        <id>09377deec39b621075ea722ed4013146</id>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-08-14 13:19:41</sys_created_on>
        <sys_id>8d377deec39b621075ea722ed4013148</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-08-14 13:19:41</sys_updated_on>
        <table>sp_widget</table>
        <use_es_latest>true</use_es_latest>
    </sys_es_latest_script>
</record_update>
