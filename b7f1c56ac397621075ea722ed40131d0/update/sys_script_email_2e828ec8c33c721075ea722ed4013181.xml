<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_script_email">
    <sys_script_email action="INSERT_OR_UPDATE">
        <name>render_manager_digest</name>
        <new_lines_to_html>false</new_lines_to_html>
        <script><![CDATA[(function runMailScript( /* GlideRecord */ current, /* TemplatePrinter */ template,
    /* Optional EmailOutbound */
    email, /* Optional GlideRecord */ email_action,
    /* Optional GlideRecord */
    event) {

    let digestData = {};
    try {
        digestData = JSON.parse(event.parm2);
    } catch (e) {
        gs.error("Could not parse manager digest data: " + e);
        return;
    }

    const stats = digestData.stats;

    if (stats) {
        template.print('<h3 style="font-family: Arial, sans-serif; color: #333;">Weekly Snapshot</h3>');
        template.print('<table style="width: 100%; text-align: center; font-family: Arial, sans-serif;"><tr>');
        template.print('<td style="padding: 10px;"><div style="font-size: 24px; font-weight: bold; color: #278efc;">' + stats.given_count + '</div><div style="font-size: 12px; color: #666;">Given</div></td>');
        template.print('<td style="padding: 10px;"><div style="font-size: 24px; font-weight: bold; color: #278efc;">' + stats.received_count + '</div><div style="font-size: 12px; color: #666;">Received</div></td>');
        template.print('<td style="padding: 10px;"><div style="font-size: 16px; font-weight: bold; color: #333;">' + stats.top_contributor + '</div><div style="font-size: 12px; color: #666;">Top Contributor(s)</div></td>');
        template.print('</tr></table>');
        template.print('<hr style="border: 0; border-top: 1px solid #e0e0e0; margin: 20px 0;" />');
    }

    template.print('<h3 style="font-family: Arial, sans-serif; color: #333;">Recognitions Given by Your Team</h3>');
    renderRecognitionList(digestData.given, 'given');
    template.print('<br/><br/>');
    template.print('<h3 style="font-family: Arial, sans-serif; color: #333;">Recognitions Received by Your Team</h3>');
	
    renderRecognitionList(digestData.received, 'received');

    function renderRecognitionList(list, type) {
        if (!list || list.length === 0) {
            template.print('<p style="font-family: Arial, sans-serif;"><em>None this week.</em></p>');
            return;
        }
        template.print('<table style="width: 100%; border-collapse: collapse; font-family: Arial, sans-serif;">');
        for (var i = 0; i < list.length; i++) {
            var item = list[i];
            var summary = '';
            if (type === 'given') {
                summary = '<b>' + item.sender + '</b> recognized <b>' + item.recipient_summary + '</b>';
            } else {
                summary = '<b>' + item.recipient + '</b> was recognized by <b>' + item.sender + '</b>';
            }
            template.print('<tr><td style="padding: 10px; border-bottom: 1px solid #e0e0e0;">');
            template.print(summary + '<br/>');
            template.print('<i style="color: #666;">"' + item.message + '"</i>');
            template.print('</td></tr>');
        }
        template.print('</table>');
    }


})(current, template, email, email_action, event);]]></script>
        <sys_class_name>sys_script_email</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-10-20 09:19:45</sys_created_on>
        <sys_id>2e828ec8c33c721075ea722ed4013181</sys_id>
        <sys_mod_count>1</sys_mod_count>
        <sys_name>render_manager_digest</sys_name>
        <sys_package display_value="PeerCentral" source="x_1794402_peerce_0">b7f1c56ac397621075ea722ed40131d0</sys_package>
        <sys_policy/>
        <sys_scope display_value="PeerCentral">b7f1c56ac397621075ea722ed40131d0</sys_scope>
        <sys_update_name>sys_script_email_2e828ec8c33c721075ea722ed4013181</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-10-20 09:24:56</sys_updated_on>
    </sys_script_email>
</record_update>
