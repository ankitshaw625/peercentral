<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[api.controller = function($scope, spUtil) {
  /* widget controller */
  var c = this;
	
	c.submitRecognition = function() {
		alert('Recognition submitted');
		var newRecognition = {
			recipient: c.recipients.value,
			category: c.category.value,
			message: c.data.message,
			action: 'createRecognition'
		};

		c.server.get(newRecognition).then(function(response) {
			spUtil.addInfoMessage(response.data.output.message);
			$('#recognition-modal').modal('hide'); 
		});
	};	
};]]></client_script>
        <controller_as>c</controller_as>
        <css>.modal-title {
	display: inline-block;
}</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>true</has_preview>
        <id>recognition_header</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>Recognition Header</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
  /* populate the 'data' object */
  /* e.g., data.table = $sp.getValue('table'); */
	
	if (input && input.action == 'createRecognition') {
		createRecognition(input);
	}
	
	function createRecognition(recognitionData) {
		var grPeerRecognitions = new GlideRecordSecure('x_1794402_peerce_0_peer_recognition');
		grPeerRecognitions.newRecord();
		
		grPeerRecognitions.sender = gs.getUserID();
		grPeerRecognitions.recipient = recognitionData.recipient;
		grPeerRecognitions.category = recognitionData.category;
		grPeerRecognitions.message = recognitionData.message;
		
		var sysId = grPeerRecognitions.insert();
		
		
		var output = {
			status: 'success',
			message: 'Recognition created successfully',
			sys_id: sysId
		};
		
		if (!sysId) {
			output = {
				status: 'failure',
				message: 'An error happened while creating the recognition: ' + grPeerRecognitions.getLastErrorMessage()
			};			
		} 
		
		data.output = output;
	}
})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-08-14 11:22:22</sys_created_on>
        <sys_id>a65c596ec31b621075ea722ed4013181</sys_id>
        <sys_mod_count>50</sys_mod_count>
        <sys_name>Recognition Header</sys_name>
        <sys_package display_value="PeerCentral" source="x_1794402_peerce_0">b7f1c56ac397621075ea722ed40131d0</sys_package>
        <sys_policy/>
        <sys_scope display_value="PeerCentral">b7f1c56ac397621075ea722ed40131d0</sys_scope>
        <sys_update_name>sp_widget_a65c596ec31b621075ea722ed4013181</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-08-15 16:18:31</sys_updated_on>
        <template><![CDATA[<header>
<h1>Recognize your teams and peers</h1>
  <p>
    Take a moment to give a shout-out to your peers for their great work!
  </p>
  
  <button class="btn btn-primary" data-toggle="modal" data-target="#recognition-modal">
    Give recognition
  </button>
</header>


 

<!-- Recognition Modal -->
<div class="modal fade" id="recognition-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="exampleModalLabel">Recognize your peers!</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      
      <div class="modal-body">
        <div class="form-group">
          <label for="recipient">Recipients: </label>
          <sn-record-picker 
    				field="c.recipients" 
    				table="'sys_user'" 
    				display-field="'name'" 
    				value-field="'sys_id'" 
    				search-fields="'name'" 
    				page-size="100" 
    				default-query="'active=true'"
						multiple="true">
					</sn-record-picker>
        </div>
        
        <div class="form-group">
          <label for="category">Category: </label>
          <sn-record-picker 
    				field="c.category" 
    				table="'x_1794402_peerce_0_recognition_category'" 
    				display-field="'name'" 
    				value-field="'sys_id'" 
    				search-fields="'name'" 
    				page-size="100">
					</sn-record-picker>
        </div>
        
        <div class="form-group">
          <label for="message">Message: </label>
          <textarea 
					id="message" class="form-control" ng-model="c.data.message" 
          placeholder="Write your recognition message here...">
					</textarea>
        </div>
      </div>
      
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" ng-click="c.submitRecognition()">Submit</button>
      </div>
    </div>
  </div>
</div>]]></template>
    </sp_widget>
    <sys_es_latest_script action="INSERT_OR_UPDATE">
        <id>a65c596ec31b621075ea722ed4013181</id>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-08-14 11:22:22</sys_created_on>
        <sys_id>ae5c596ec31b621075ea722ed4013184</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-08-14 11:22:22</sys_updated_on>
        <table>sp_widget</table>
        <use_es_latest>true</use_es_latest>
    </sys_es_latest_script>
</record_update>
