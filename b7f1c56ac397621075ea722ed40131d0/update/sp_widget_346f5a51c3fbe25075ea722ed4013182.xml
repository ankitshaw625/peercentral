<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[api.controller = function ($scope) {
  var c = this;

  //c.days = c.data.days;
  c.isLoading = false;

  c.activeTab = c.data.hasRecommendations ? 'actions' : 'reports';

  c.setTab = function (tabName) {
    c.activeTab = tabName;
  };

  $scope.$on('highlights.timeframe.filter.updated', function (event, data) {
    setDays(data.selected.value);
  });

  function setDays(updatedDays) {
    if (c.data.days === updatedDays) return;

    c.isLoading = true;
    c.data.days = updatedDays;

    c.server.update().then(function () {
      c.isLoading = false;
    });
  }

}]]></client_script>
        <controller_as>c</controller_as>
        <css>.recognition-highlights {
    margin-top: 1rem;
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.08);
    overflow: hidden;
    position: relative;
  	border: 0.1rem solid #eee;
}

.recognition-highlights-title {
    font-size: 1.75rem;
    padding: 1rem 1.25rem;
    margin: 0;
    font-weight: 600;
    background: #fafafa;
    color: #333;
}

.custom-tabs {
    margin: 0;
  	margin-bottom: 1rem;
    border-bottom: 1px solid #eee;
    background: #f9f9f9;
}

.custom-tabs &gt; li &gt; a {
    padding: 1rem 0.5rem;
    font-weight: 500;
    color: #555;
    border: none;
    border-radius: 0;
    transition: background-color 0.2s ease, color 0.2s ease;
    outline: none;
}

.custom-tabs &gt; li.active &gt; a {
    border-bottom: 2px solid #2d7524;
    outline: none;
}

.custom-tabs &gt; li &gt; a:hover {
    cursor: pointer;
    outline: none;
}

.tab-content {
    padding: 0;
}

/* Panels */
.recognition-highlights .panel {
    border-radius: 6px;
    box-shadow: none;
}

.recognition-highlights .panel-heading {
    background: #fdfdfd;
    border-bottom: 1px solid #eee;
    padding: 1.25rem;
}

.recognition-highlights .panel-title a {
    display: block;
    color: #333;
    font-weight: 500;
    text-decoration: none;
}

.recognition-highlights .panel-title a:hover {
    color: #0078d7;
}

.recognition-highlights .panel-body {
    padding: 1rem 1rem 0 1rem;
}

/* Loading overlay */
.loading-overlay {
    position: absolute;
    inset: 0;
    background: rgba(255, 255, 255, 0.85);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10;
}

.spinner .glyphicon {
    animation: spin 1s linear infinite;
    font-size: 1.5rem;
    color: #0078d7;
}

@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

.no-data {
    text-align: center;
    padding: 2rem 1rem;
    color: #777;
    border: 1px dashed #ddd;
    border-radius: 6px;
    background: #fafafa;
}

.no-data .glyphicon {
    font-size: 2rem;
    margin-bottom: 0.5rem;
    color: #bbb;
}

.filter-wrapper {
    padding: 1rem;
  	padding-top: 0;
  	background: #fafafa;
    border-bottom: .1rem solid #ccc;
}

.recognition-highlights .panel-title a::after {
    content: '\e258';
    font-family: 'Glyphicons Halflings';
    position: absolute;
    right: 1rem;
    color: #999;
    transition: transform 0.2s ease;
}

.recognition-highlights .panel-title a[aria-expanded='true']::after {
    transform: rotate(90deg);
    color: #0078d7;
}

.recommendations-pane .panel-heading {
    padding: 1rem;
}

#reportsAccordion {
	margin-bottom: 0;
}

</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>true</has_preview>
        <id>recognition_highlights</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>Recognition Highlights</name>
        <option_schema>[{"hint":"Number of days to consider for recognitions","name":"days","section":"Data","default_value":"90","label":"Days","type":"integer"}]</option_schema>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function () {

  data.days = input ? input.days : options.days;

  var userCount = options.users || 3;

  var topContributors = new x_1794402_peerce_0.RecognitionUtils().getTopRecognitionContributors(data.days, userCount);

  data.topContributorOptions = {
    days: Number(data.days),
    show_title: false,
    topContributors: topContributors
  };

  var myRecognitionSnapshot = new x_1794402_peerce_0.RecognitionUtils().getUserRecognitionSnapshot(gs.getUserID(), data.days);

  data.recognitionSnapshotOptions = {
    days: Number(data.days),
    show_title: false,
    recognitionSnapshot: myRecognitionSnapshot
  };

  data.timeframeFilterWidget = $sp.getWidget('single-select-filter', {
    title: 'Timeframe',
    eventName: 'highlights.timeframe.filter.updated',
    choices: [
      { display: 'Last 90 days', value: '90' },
      { display: 'Last 30 days', value: '30' },
      { display: 'Last 7 days', value: '7' }
    ],

    initialSelection: 'all'
  });



  // Get recommendations widget for managers
  data.hasRecommendations = false;

  if (gs.hasRole('x_1794402_peerce_0.manager')) {
    var userId = gs.getUserID();

    const recommendations = new x_1794402_peerce_0.RecognitionRecommender().getNewRecommendationsForManager(userId);

    if (recommendations && recommendations.length > 0) {
      data.hasRecommendations = true;

      data.unsungHeroesWidget = $sp.getWidget('unsung-hero-recommendations', {
        show_title: false,
        recommendations: recommendations
      });
    }
  }

})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-09-04 15:34:14</sys_created_on>
        <sys_id>346f5a51c3fbe25075ea722ed4013182</sys_id>
        <sys_mod_count>175</sys_mod_count>
        <sys_name>Recognition Highlights</sys_name>
        <sys_package display_value="PeerCentral" source="x_1794402_peerce_0">b7f1c56ac397621075ea722ed40131d0</sys_package>
        <sys_policy/>
        <sys_scope display_value="PeerCentral">b7f1c56ac397621075ea722ed40131d0</sys_scope>
        <sys_update_name>sp_widget_346f5a51c3fbe25075ea722ed4013182</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-11-19 14:56:49</sys_updated_on>
        <template><![CDATA[<div class="recognition-highlights">
  <h3 class="recognition-highlights-title" ng-if="!c.data.hasRecommendations"><strong>Recognition highlights</strong></h3>

  <!-- Loading Overlay -->
  <div ng-if="c.isLoading" class="loading-overlay">
    <div class="spinner">
      <i class="glyphicon glyphicon-refresh spinning"></i> Loading...
    </div>
  </div>

  <ul class="nav nav-tabs custom-tabs" ng-if="c.data.hasRecommendations">
    <li ng-class="{'active': c.activeTab === 'actions'}">
      <a ng-click="c.setTab('actions')">Recognition Opportunities</a>
    </li>
    <li ng-class="{'active': c.activeTab === 'reports'}">
      <a ng-click="c.setTab('reports')">Recognition Highlights</a>
    </li>
  </ul>


  <div class="tab-content">

    <div class="tab-pane recommendations-pane" ng-class="{'active': c.activeTab === 'actions'}"
      ng-if="c.data.hasRecommendations">

      <div class="panel panel-default">
        <div class="panel-heading">
          <h4 class="panel-title">
            <i class="glyphicon glyphicon-gift"></i> Unsung Hero Recommendations
          </h4>
        </div>

        <div class="panel-body">
          <sp-widget widget="c.data.unsungHeroesWidget"></sp-widget>
        </div>
      </div>

    </div>

    <div class="tab-pane" ng-class="{'active': c.activeTab === 'reports'}">

      <div class="filter-wrapper">
        <sp-widget widget="c.data.timeframeFilterWidget"></sp-widget>
      </div>

      <div class="panel-group" id="reportsAccordion">

        <div class="panel panel-default">
          <div class="panel-heading">
            <h4 class="panel-title">
              <a data-toggle="collapse" data-parent="#reportsAccordion" data-target="#collapseContributors"
                style="cursor: pointer;">
                <i class="glyphicon glyphicon-stats"></i> Top Contributors (Last {{c.data.days}} Days)
              </a>
            </h4>
          </div>

          <div id="collapseContributors" class="panel-collapse collapse in">
            <div class="panel-body report-container">
              <widget id="top_contributors" options='data.topContributorOptions'></widget>
            </div>
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading">
            <h4 class="panel-title">
              <a data-toggle="collapse" data-parent="#reportsAccordion" data-target="#collapseSnapshot"
                style="cursor: pointer;">
                <i class="glyphicon glyphicon-stats"></i> My Recognition Snapshot (Last {{c.data.days}} Days)
              </a>
            </h4>
          </div>
          <div id="collapseSnapshot" class="panel-collapse collapse">
            <div class="panel-body report-container">
              <widget id="my_recognition_snapshot" options='data.recognitionSnapshotOptions'></widget>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>]]></template>
    </sp_widget>
    <sys_es_latest_script action="INSERT_OR_UPDATE">
        <id>346f5a51c3fbe25075ea722ed4013182</id>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-09-04 15:34:14</sys_created_on>
        <sys_id>f46f5a51c3fbe25075ea722ed4013185</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-09-04 15:34:14</sys_updated_on>
        <table>sp_widget</table>
        <use_es_latest>true</use_es_latest>
    </sys_es_latest_script>
</record_update>
